问题可以看成：给定一个只由1,2,3组成的序列，求修改最少次数将其改造成一个不上升或不下降序列。

先只讨论不下降序列。
f[i,j]表示到第i位，且将第i位改成j的最少修改次数使得1~i为一个不下降序列。
则方程为：
f[i,j]=min(f[i-1,k])+t (k<=j)(j=a[i]时t=0，否则t=1)